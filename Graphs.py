from matplotlib.pyplot import *
from numpy import *
from random import *

# Ajustes
#tmax = 1000
#step = 0.5
#mu = 0.5
#sig = 0.2

alphas = 0.01
alphaf = 0.1
wsi = 0
wfi = 0
ys = 1.0
yf = 1.0

## ----
#t = arange(0, tmax, step)
wf = [wfi]
ws = [wsi]
we = [0]
wa = []

wa.append(0.000579428) # 0
wa.append(0.0276759) # 1
wa.append(0.0498856) # 2
wa.append(0.0684898) # 3
wa.append(0.00594738) # 4
wa.append(0.00670456) # 5
wa.append(0.00963802) # 6
wa.append(0.0164363) # 7
wa.append(0.0282327) # 8
wa.append(0.0189098) # 9
wa.append(0.0165138) # 10
wa.append(0.015157) # 11
wa.append(0.0153263) # 12
wa.append(0.0130153) # 13
wa.append(0.0153628) # 14
wa.append(0.0146105) # 15
wa.append(0.0114608) # 16
wa.append(0.0216952) # 17
wa.append(0.0251639) # 18
wa.append(0.0296937) # 19
wa.append(0.0263385) # 20
wa.append(0.0316062) # 21
wa.append(0.0340778) # 22
wa.append(0.0246166) # 23
wa.append(0.0252372) # 24
wa.append(0.0121621) # 25
wa.append(0.0139327) # 26
wa.append(0.0141278) # 27
wa.append(0.00374426) # 28
wa.append(0.00171963) # 29
wa.append(0.00883329) # 30
wa.append(0.011333) # 31
wa.append(0.0146623) # 32
wa.append(0.0157939) # 33
wa.append(0.036219) # 34
wa.append(0.0378558) # 35
wa.append(0.0349857) # 36
wa.append(0.0276731) # 37
wa.append(0.0401356) # 38
wa.append(0.0489442) # 39
wa.append(0.0340627) # 40
wa.append(0.0341319) # 41
wa.append(0.0316527) # 42
wa.append(0.0303385) # 43
wa.append(0.0408405) # 44
wa.append(0.0371476) # 45
wa.append(0.0343825) # 46
wa.append(0.0346433) # 47
wa.append(0.0325384) # 48
wa.append(0.0310664) # 49
wa.append(0.0247001) # 50
wa.append(0.0278888) # 51
wa.append(0.0258191) # 52
wa.append(0.0282912) # 53
wa.append(0.0299538) # 54
wa.append(0.0287536) # 55
wa.append(0.0289736) # 56
wa.append(0.0175117) # 57
wa.append(0.0120823) # 58
wa.append(0.0132628) # 59
wa.append(0.0124449) # 60
wa.append(0.0140646) # 61
wa.append(0.0120952) # 62
wa.append(0.0135083) # 63
wa.append(0.0143621) # 64
wa.append(0.00622893) # 65
wa.append(0.0024829) # 66
wa.append(0.00356807) # 67
wa.append(0.0160581) # 68
wa.append(0.0138618) # 69
wa.append(0.013298) # 70
wa.append(0.00215585) # 71
wa.append(0.00116127) # 72
wa.append(0.000486439) # 73
wa.append(6.81086e-05) # 74
wa.append(0.000114255) # 75
wa.append(0.0116686) # 76
wa.append(0.0125831) # 77
wa.append(0.0156311) # 78
wa.append(0.0181077) # 79
wa.append(0.00490339) # 80
wa.append(0.0059986) # 81
wa.append(0.00627367) # 82
wa.append(0.00770622) # 83
wa.append(0.00894722) # 84
wa.append(0.0160312) # 85
wa.append(0.0134245) # 86
wa.append(0.0289679) # 87
wa.append(0.0453268) # 88
wa.append(0.0392894) # 89
wa.append(0.0325394) # 90
wa.append(0.0495041) # 91
wa.append(0.0576131) # 92
wa.append(0.0472337) # 93
wa.append(0.0477162) # 94
wa.append(0.0229842) # 95
wa.append(0.036552) # 96
wa.append(0.030392) # 97
wa.append(0.0303471) # 98
wa.append(0.026839) # 99
wa.append(0.0295418) # 100
wa.append(0.0306007) # 101
wa.append(0.0153012) # 102
wa.append(0.0106341) # 103
wa.append(0.0353518) # 104
wa.append(0.0323713) # 105
wa.append(0.0319987) # 106
wa.append(0.0385425) # 107
wa.append(0.0365001) # 108
wa.append(0.0339734) # 109
wa.append(0.0415357) # 110
wa.append(7.9493e-05) # 111
wa.append(0.00250138) # 112
wa.append(0.0064395) # 113
wa.append(0.014068) # 114
wa.append(2.07618e-05) # 115
wa.append(0.009497) # 116
wa.append(0.00815175) # 117
wa.append(0.00824673) # 118
wa.append(0.0114804) # 119
wa.append(0.0111706) # 120
wa.append(0.0130521) # 121
wa.append(0.00970113) # 122
wa.append(0.0135387) # 123
wa.append(0.0122047) # 124
wa.append(0.0154013) # 125
wa.append(0.0118449) # 126
wa.append(0.0180646) # 127
wa.append(0.0177926) # 128
wa.append(0.0174511) # 129
wa.append(0.0221036) # 130
wa.append(1.97431e-06) # 131
wa.append(0.0123637) # 132
wa.append(0.010132) # 133
wa.append(0.00862691) # 134
wa.append(0.006573) # 135
wa.append(0.0070002) # 136
wa.append(0.00677184) # 137
wa.append(0.00874718) # 138
wa.append(0.00660822) # 139
wa.append(0.0107779) # 140
wa.append(0.0132474) # 141
wa.append(0.0107954) # 142
wa.append(0.00347951) # 143
wa.append(0.00815004) # 144
wa.append(0.0098427) # 145
wa.append(0.0114547) # 146
wa.append(0.0110257) # 147
wa.append(0.0189609) # 148
wa.append(0.0174535) # 149
wa.append(0.0176497) # 150
wa.append(0.0203492) # 151
wa.append(0.0254589) # 152
wa.append(0.0380825) # 153
wa.append(0.0320353) # 154
wa.append(0.0120132) # 155
wa.append(0.0281044) # 156
wa.append(0.0411122) # 157
wa.append(0.0497799) # 158
wa.append(0.0340467) # 159
wa.append(0.00618402) # 160
wa.append(0.021482) # 161
wa.append(0.0202388) # 162
wa.append(0.0172324) # 163
wa.append(0.013298) # 164
wa.append(0.007069) # 165
wa.append(0.00328327) # 166
wa.append(0.0279598) # 167
wa.append(0.0383407) # 168
wa.append(0.0398945) # 169
wa.append(0.0396917) # 170
wa.append(0.0372202) # 171
wa.append(0.00158733) # 172
wa.append(0.0125827) # 173
wa.append(0.0128629) # 174
wa.append(0.0137002) # 175
wa.append(0.0118376) # 176
wa.append(0.0113015) # 177
wa.append(0.0385259) # 178
wa.append(0.0396605) # 179
wa.append(0.000962177) # 180
wa.append(0.00985188) # 181
wa.append(0.0458902) # 182
wa.append(0.0420211) # 183
wa.append(0.0351354) # 184
wa.append(0.0148433) # 185
wa.append(0.0387327) # 186
wa.append(0.0425326) # 187
wa.append(0.040848) # 188
wa.append(0.0432022) # 189
wa.append(0.0439766) # 190
wa.append(0.046582) # 191
wa.append(0.0454683) # 192
wa.append(0.0497993) # 193
wa.append(0.0495168) # 194
wa.append(0.048084) # 195
wa.append(0.0518796) # 196
wa.append(0.0515373) # 197
wa.append(0.0505717) # 198
wa.append(0.052947) # 199
wa.append(1.47977e-18) # 200
wa.append(4.6471e-21) # 201
wa.append(8.95542e-23) # 202
wa.append(0.000265064) # 203
wa.append(7.07907e-25) # 204
wa.append(0.0104512) # 205
wa.append(0.00947698) # 206
wa.append(0.00648623) # 207
wa.append(0.00364249) # 208
wa.append(0.00221501) # 209
wa.append(0.00189354) # 210
wa.append(0.00543785) # 211
wa.append(0.0223135) # 212
wa.append(0.0235102) # 213
wa.append(0.0283516) # 214
wa.append(0.0403318) # 215
wa.append(0.0378277) # 216
wa.append(0.0468105) # 217
wa.append(0.0407773) # 218
wa.append(0.00922987) # 219
wa.append(0.017022) # 220
wa.append(0.0475345) # 221
wa.append(0.014129) # 222
wa.append(0.0126442) # 223
wa.append(0.0103054) # 224
wa.append(0.0192287) # 225
wa.append(0.0134067) # 226
wa.append(0.00294408) # 227
wa.append(0.000706005) # 228
wa.append(0.0163057) # 229
wa.append(0.0242677) # 230
wa.append(0.0258043) # 231
wa.append(0.0308578) # 232
wa.append(0.0298238) # 233
wa.append(0.0285835) # 234
wa.append(0.0251055) # 235
wa.append(0.0320137) # 236
wa.append(0.0288157) # 237
wa.append(0.0310392) # 238
wa.append(0.0219637) # 239
wa.append(0.0199133) # 240
wa.append(0.00868116) # 241
wa.append(0.0241121) # 242
wa.append(0.0367015) # 243
wa.append(0.0401447) # 244
wa.append(0.0385143) # 245
wa.append(0.0339924) # 246
wa.append(0.00808057) # 247
wa.append(0.0165401) # 248
wa.append(0.0299682) # 249
wa.append(0.0368824) # 250
wa.append(0.0435568) # 251
wa.append(0.0394193) # 252
wa.append(0.0422126) # 253
wa.append(0.0435866) # 254
wa.append(0.0434672) # 255
wa.append(0.0207758) # 256
wa.append(0.0326694) # 257
wa.append(0.0323987) # 258
wa.append(0.0303344) # 259
wa.append(0.0319975) # 260
wa.append(0.0342431) # 261
wa.append(0.033988) # 262
wa.append(0.0371426) # 263
wa.append(0.0250742) # 264
wa.append(0.00254434) # 265
wa.append(0.013298) # 266
wa.append(0.0190812) # 267
wa.append(0.0221329) # 268
wa.append(0.0212247) # 269
wa.append(0.0223107) # 270
wa.append(0.019176) # 271
wa.append(0.013298) # 272
wa.append(0.00532478) # 273
wa.append(0.0226754) # 274
wa.append(0.0420411) # 275
wa.append(0.0396474) # 276
wa.append(0.0247074) # 277
wa.append(0.0076109) # 278
wa.append(0.0123091) # 279
wa.append(0.0213626) # 280
wa.append(0.0328807) # 281
wa.append(0.0377656) # 282
wa.append(0.0372606) # 283
wa.append(0.0262438) # 284
wa.append(0.0278761) # 285
wa.append(0.00998849) # 286
wa.append(0.0283365) # 287
wa.append(0.029699) # 288
wa.append(0.0151384) # 289
wa.append(0.0142292) # 290
wa.append(0.0150889) # 291
wa.append(0.0169665) # 292
wa.append(0.0156616) # 293
wa.append(0.0162251) # 294
wa.append(0.0165226) # 295
wa.append(0.0159207) # 296
wa.append(0.0164903) # 297
wa.append(0.0172976) # 298
wa.append(0.0177053) # 299
wa.append(0.000986699) # 300
wa.append(0.00818073) # 301
wa.append(0.0172813) # 302
wa.append(0.0189623) # 303
wa.append(0.0320617) # 304
wa.append(0.0320392) # 305
wa.append(0.0249943) # 306
wa.append(0.025484) # 307
wa.append(0.0285125) # 308
wa.append(0.0297401) # 309
wa.append(0.0330392) # 310
wa.append(0.031862) # 311
wa.append(0.0348795) # 312
wa.append(0.0348607) # 313
wa.append(0.0345147) # 314
wa.append(0.0380661) # 315
wa.append(0.000603279) # 316
wa.append(0.00834771) # 317
wa.append(0.00853934) # 318
wa.append(0.0153888) # 319
wa.append(0.0179403) # 320
wa.append(0.0432393) # 321
wa.append(0.0450305) # 322
wa.append(0.0421276) # 323
wa.append(0.0400422) # 324
wa.append(0.0472655) # 325
wa.append(0.024602) # 326
wa.append(0.0201963) # 327
wa.append(0.0203256) # 328
wa.append(0.0089398) # 329
wa.append(0.0100508) # 330
wa.append(0.0141406) # 331
wa.append(0.0115114) # 332
wa.append(0.0135136) # 333
wa.append(0.0120571) # 334
wa.append(0.0133553) # 335
wa.append(0.019492) # 336
wa.append(0.0125481) # 337
wa.append(0.0143091) # 338
wa.append(0.0166567) # 339
wa.append(0.0172518) # 340
wa.append(0.0210711) # 341
wa.append(0.0231018) # 342
wa.append(0.0260111) # 343
wa.append(0.027521) # 344
wa.append(0.0278289) # 345
wa.append(0.031852) # 346
wa.append(0.0343462) # 347
wa.append(0.0375854) # 348
wa.append(0.0432332) # 349
wa.append(0.039076) # 350
wa.append(0.0091475) # 351
wa.append(0.0100082) # 352
wa.append(0.0103219) # 353
wa.append(0.0110847) # 354
wa.append(0.0193668) # 355
wa.append(0.0087973) # 356
wa.append(0.00411352) # 357
wa.append(0.0123506) # 358
wa.append(0.0256744) # 359
wa.append(0.028432) # 360
wa.append(0.035606) # 361
wa.append(0.0367947) # 362
wa.append(0.0373285) # 363
wa.append(0.036306) # 364
wa.append(0.0391882) # 365
wa.append(0.0388916) # 366
wa.append(0.0423639) # 367
wa.append(0.0441743) # 368
wa.append(0.04409) # 369
wa.append(0.0462691) # 370
wa.append(0.0468738) # 371
wa.append(0.0487025) # 372
wa.append(0.0442384) # 373
wa.append(0.0435894) # 374
wa.append(0.00124561) # 375
wa.append(0.0127931) # 376
wa.append(0.0137012) # 377
wa.append(0.0138902) # 378
wa.append(0.0130642) # 379
wa.append(0.00924631) # 380
wa.append(0.00562665) # 381
wa.append(0.037958) # 382
wa.append(0.0568997) # 383
wa.append(0.0375431) # 384
wa.append(0.0215732) # 385
wa.append(0.0157526) # 386
wa.append(0.019191) # 387
wa.append(0.0329122) # 388
wa.append(0.043166) # 389
wa.append(0.0434299) # 390
wa.append(0.0299483) # 391
wa.append(0.0434538) # 392
wa.append(0.0467161) # 393
wa.append(0.0465745) # 394
wa.append(0.0321875) # 395
wa.append(0.0469039) # 396
wa.append(0.0392025) # 397
wa.append(0.0413242) # 398
wa.append(0.0457098) # 399
wa.append(0.000497786) # 400
wa.append(0.00653023) # 401
wa.append(0.00598884) # 402
wa.append(0.00325236) # 403
wa.append(0.00214183) # 404
wa.append(0.00063798) # 405
wa.append(0.00313479) # 406
wa.append(0.0128016) # 407
wa.append(0.0181389) # 408
wa.append(0.0228511) # 409
wa.append(0.034038) # 410
wa.append(0.0465553) # 411
wa.append(0.0119827) # 412
wa.append(0.0218183) # 413
wa.append(0.0291205) # 414
wa.append(0.0328667) # 415
wa.append(0.0362313) # 416
wa.append(0.0505611) # 417
wa.append(0.0539999) # 418
wa.append(0.0580945) # 419
wa.append(0.0440871) # 420
wa.append(0.043208) # 421
wa.append(0.0471669) # 422
wa.append(0.0143868) # 423
wa.append(0.00094192) # 424
wa.append(0.00435728) # 425
wa.append(0.00580938) # 426
wa.append(0.00866705) # 427
wa.append(0.0132525) # 428
wa.append(0.0160726) # 429
wa.append(0.0162872) # 430
wa.append(0.00835266) # 431
wa.append(0.0252679) # 432
wa.append(0.0192655) # 433
wa.append(0.00976314) # 434
wa.append(0.00832694) # 435
wa.append(0.0218351) # 436
wa.append(0.029013) # 437
wa.append(0.0315112) # 438
wa.append(0.037489) # 439
wa.append(0.0439523) # 440
wa.append(0.0501627) # 441
wa.append(0.052251) # 442
wa.append(0.0142247) # 443
wa.append(0.0188674) # 444
wa.append(0.0211249) # 445
wa.append(0.0179676) # 446
wa.append(0.0202371) # 447
wa.append(0.0217968) # 448
wa.append(0.0211185) # 449
wa.append(0.0316255) # 450
wa.append(0.03128) # 451
wa.append(0.027926) # 452
wa.append(6.42353e-05) # 453
wa.append(0.000957672) # 454
wa.append(0.00232878) # 455
wa.append(0.00524868) # 456
wa.append(0.013298) # 457
wa.append(0.013298) # 458
wa.append(0.013298) # 459
wa.append(0.013298) # 460
wa.append(0.013298) # 461
wa.append(0.00154318) # 462
wa.append(0.00650532) # 463
wa.append(0.0127181) # 464
wa.append(0.00951781) # 465
wa.append(0.00873133) # 466
wa.append(0.00887444) # 467
wa.append(0.0104683) # 468
wa.append(0.00939966) # 469
wa.append(0.00999215) # 470
wa.append(0.0110236) # 471
wa.append(0.0120142) # 472
wa.append(0.0114896) # 473
wa.append(0.0124667) # 474
wa.append(0.0135341) # 475
wa.append(0.0150306) # 476
wa.append(0.0155809) # 477
wa.append(0.0411918) # 478
wa.append(0.0395833) # 479
wa.append(0.0344133) # 480
wa.append(0.0373805) # 481
wa.append(0.0322963) # 482
wa.append(0.0118126) # 483
wa.append(0.0179624) # 484
wa.append(0.0255766) # 485
wa.append(0.0278267) # 486
wa.append(0.0322552) # 487
wa.append(0.0348227) # 488
wa.append(0.0355174) # 489
wa.append(0.0371639) # 490
wa.append(0.0398277) # 491
wa.append(0.0364615) # 492
wa.append(0.0414346) # 493
wa.append(0.0378885) # 494
wa.append(0.0408541) # 495
wa.append(0.0410348) # 496
wa.append(0.0439741) # 497
wa.append(0.0424205) # 498
wa.append(0.0440144) # 499
wa.append(0.0471922) # 500
wa.append(0.051559) # 501
wa.append(0.0312201) # 502
wa.append(0.00832207) # 503
wa.append(0.0202104) # 504
wa.append(0.0271005) # 505
wa.append(0.0295929) # 506
wa.append(0.0350909) # 507
wa.append(0.0380446) # 508
wa.append(0.0237697) # 509
wa.append(0.0119394) # 510
wa.append(8.13929e-05) # 511
wa.append(2.29461e-05) # 512
wa.append(9.27517e-06) # 513
wa.append(0.000122024) # 514
wa.append(0.00792272) # 515
wa.append(0.0170606) # 516
wa.append(0.00555902) # 517
wa.append(0.00921524) # 518
wa.append(0.0241495) # 519
wa.append(0.0235608) # 520
wa.append(0.0328638) # 521
wa.append(0.0334664) # 522
wa.append(0.0347175) # 523
wa.append(0.0500905) # 524
wa.append(0.056361) # 525
wa.append(0.0865128) # 526
wa.append(0.003602) # 527
wa.append(0.0328529) # 528
wa.append(0.0382575) # 529
wa.append(0.039397) # 530
wa.append(0.03832) # 531
wa.append(0.0400461) # 532
wa.append(0.0429375) # 533
wa.append(0.043015) # 534
wa.append(0.0435871) # 535
wa.append(0.0467883) # 536
wa.append(0.049698) # 537
wa.append(0.045473) # 538
wa.append(0.0525493) # 539
wa.append(0.0505023) # 540
wa.append(0.0538653) # 541
wa.append(0.0578326) # 542
wa.append(0.0595587) # 543
wa.append(0.064073) # 544
wa.append(0.0665784) # 545
wa.append(0.0626757) # 546
wa.append(0.013298) # 547
wa.append(0.013298) # 548
wa.append(0.013298) # 549
wa.append(0.00935927) # 550
wa.append(0.0186487) # 551
wa.append(0.0343443) # 552
wa.append(0.0449067) # 553
wa.append(0.0333917) # 554
wa.append(0.0382943) # 555
wa.append(0.0384846) # 556
wa.append(0.0408015) # 557
wa.append(0.0396866) # 558
wa.append(0.0435826) # 559
wa.append(0.0486973) # 560
wa.append(0.0447965) # 561
wa.append(0.0364309) # 562
wa.append(0.0249712) # 563
wa.append(0.0185896) # 564
wa.append(0.0193445) # 565
wa.append(0.0188564) # 566
wa.append(0.0083409) # 567
wa.append(0.0170668) # 568
wa.append(0.0214682) # 569
wa.append(0.0211215) # 570
wa.append(0.0293927) # 571
wa.append(0.0430521) # 572
wa.append(0.04211) # 573
wa.append(0.0393841) # 574
wa.append(0.0431866) # 575
wa.append(0.0438122) # 576
wa.append(0.0429389) # 577
wa.append(0.0398052) # 578
wa.append(0.0340173) # 579
wa.append(0.0354488) # 580
wa.append(0.0397261) # 581
wa.append(0.0452118) # 582
wa.append(0.0456227) # 583
wa.append(0.0555214) # 584
wa.append(0.0551741) # 585
wa.append(0.0683238) # 586
wa.append(0.0481359) # 587
wa.append(0.0265164) # 588
wa.append(0.0186266) # 589
wa.append(0.020409) # 590
wa.append(0.0200466) # 591
wa.append(0.0216988) # 592
wa.append(0.0237924) # 593
wa.append(0.0261583) # 594
wa.append(0.026567) # 595
wa.append(0.0242804) # 596
wa.append(0.013298) # 597
wa.append(0.013298) # 598
wa.append(0.013298) # 599

#for i in range(len(t)):
#    mean = mu*(max(1-exp(-(t[i]/5))-exp(-((950-t[i])/1)), 0))
#    #wa.append(mean)
#    wa.append(gauss(mean, sig))

for i in range(len(wa)-1):
    wf.append(wf[i]+alphaf*(yf*wa[i+1]-wf[i]))
    ws.append(ws[i]+alphas*(ys*wa[i+1]-ws[i]))
    we.append(max(0, 1-wf[i+1]/ws[i+1]))

t = arange(0, len(wa), 1)
#for i in range(len(wa)):
#    we.append(wf[i]-ws[i])

l = []
for i in range(len(wa)):
    l.append(0)
l[111] = 0.01
l[200] = 0.01
l[300] = 0.01
l[400] = 0.01
l[511] = 0.01

for i in range(len(we)):
    if we[i] > 0:
        we[i] = 0.05

#print l

plot(t, wf, 'r', t, ws, 'b', t, wa, 'g', t, we, 'y', t, l, 'k')
show()
